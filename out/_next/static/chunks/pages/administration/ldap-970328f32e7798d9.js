(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[275],{204:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/administration/ldap",function(){return a(8494)}])},8494:function(e,n,a){"use strict";a.r(n),a.d(n,{__toc:function(){return r}});var t=a(5893),o=a(2673),d=a(3058),s=a(9812);a(6834);var i=a(2643);let r=[{depth:2,value:"Настройка клиента",id:"настройка-клиента"},{depth:2,value:"ssh keys",id:"ssh-keys"}];function _createMdxContent(e){let n=Object.assign({h1:"h1",p:"p",a:"a",code:"code",h2:"h2",pre:"pre",span:"span"},(0,i.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"Настройка авторизации LDAP"}),"\n",(0,t.jsx)(n.h1,{children:"Настройка сервера"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://computingforgeeks.com/install-and-configure-openldap-server-ubuntu/",children:"https://computingforgeeks.com/install-and-configure-openldap-server-ubuntu/"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"sudo apt -y install slapd ldap-utils"})}),"\n",(0,t.jsxs)(n.p,{children:["Для повторной настройки сервера: ",(0,t.jsx)(n.code,{children:"sudo dpkg-reconfigure slapd"})]}),"\n",(0,t.jsx)(n.h2,{id:"настройка-клиента",children:"Настройка клиента"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://computingforgeeks.com/how-to-configure-ubuntu-as-ldap-client/",children:"https://computingforgeeks.com/how-to-configure-ubuntu-as-ldap-client/"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"sudo apt -y install libnss-ldap libpam-ldap ldap-utils"})}),"\n",(0,t.jsxs)(n.p,{children:["Для повторной настройки клиента: ",(0,t.jsx)(n.code,{children:"sudo dpkg-reconfigure ldap-auth-config"})]}),"\n",(0,t.jsx)(n.h2,{id:"ssh-keys",children:"ssh keys"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://openssh-ldap-pubkey.readthedocs.io/en/latest/openldap.html",children:"https://openssh-ldap-pubkey.readthedocs.io/en/latest/openldap.html"})}),"\n",(0,t.jsx)(n.p,{children:"Добавить аттрибут"}),"\n",(0,t.jsx)(n.pre,{"data-language":"text","data-theme":"default",children:(0,t.jsxs)(n.code,{"data-language":"text","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"curl -o openssh-lpk.ldif https://openssh-ldap-pubkey.readthedocs.io/en/latest/_downloads/484070d0b1da0579a2bc2dda709186fd/openssh-lpk.ldif.txt"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"sudo ldapadd -H ldapi:/// -Y EXTERNAL -f openssh-lpk.ldif"})})]})}),"\n",(0,t.jsx)(n.p,{children:"Создать файл /opt/bin/ldapauth.sh"}),"\n",(0,t.jsx)(n.pre,{"data-language":"text","data-theme":"default",children:(0,t.jsxs)(n.code,{"data-language":"text","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"#!/bin/bash"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"uid=$1"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"baseDN=ou=users,dc=iconicompany,dc=com"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"ldapsearch -x -b $baseDN -s sub \"(&(objectclass=posixAccount)(uid=$uid))\" | sed -n '/^ /{H;d};/sshPublicKey:/x;$g;s/\\n *//g;s/sshPublicKey: //gp'"})})]})}),"\n",(0,t.jsx)(n.p,{children:"/etc/ssh/sshd_config.d/ldapauth.conf:"}),"\n",(0,t.jsx)(n.pre,{"data-language":"text","data-theme":"default",children:(0,t.jsxs)(n.code,{"data-language":"text","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"AuthorizedKeysCommand /opt/bin/ldapauth.sh"})}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"AuthorizedKeysCommandUser root"})})]})}),"\n",(0,t.jsx)(n.p,{children:"В конце:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"sudo service sshd restart"})})]})}let l={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.a)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/administration/ldap.md",route:"/administration/ldap",timestamp:1680095957e3,pageMap:[{kind:"Meta",data:{index:"Introduction",development:"Разработка",administration:"Servers, databases, clusters","project-catalogue":"Каталог проектов",onboarding:"Onboarding for DEVELOPER","project-managment":"Управление проектами",contact:{title:"Contact ↗",type:"page",href:"https://iconicompany.com/",newWindow:!0}}},{kind:"Folder",name:"administration",route:"/administration",children:[{kind:"Meta",data:{server:"Как создать и настроить сервер на Ubuntu",k3s:"Установка k3s",ldap:"Ldap",putting:"Putting",werf:"Werf"}},{kind:"MdxPage",name:"k3s",route:"/administration/k3s"},{kind:"MdxPage",name:"ldap",route:"/administration/ldap"},{kind:"MdxPage",name:"putting",route:"/administration/putting"},{kind:"MdxPage",name:"server",route:"/administration/server"},{kind:"MdxPage",name:"werf",route:"/administration/werf"}]},{kind:"Folder",name:"development",route:"/development",children:[{kind:"Meta",data:{guidelines:"Гайдлайны",nodejs:"Nodejs docs",telegram:"Telegram"}},{kind:"Folder",name:"guidelines",route:"/development/guidelines",children:[{kind:"Meta",data:{dod:"Definition of Done",recommendations:"Recommendations"}},{kind:"MdxPage",name:"dod",route:"/development/guidelines/dod"},{kind:"MdxPage",name:"recommendations",route:"/development/guidelines/recommendations"}]},{kind:"Folder",name:"nodejs",route:"/development/nodejs",children:[{kind:"Meta",data:{workstation:"How to setup Nodejs developer workstation",packages:"Snippets for packages"}},{kind:"MdxPage",name:"packages",route:"/development/nodejs/packages"},{kind:"MdxPage",name:"workstation",route:"/development/nodejs/workstation"}]},{kind:"MdxPage",name:"telegram",route:"/development/telegram"}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"onboarding",route:"/onboarding"},{kind:"Folder",name:"project-catalogue",route:"/project-catalogue",children:[{kind:"Meta",data:{bystrobank:"БыстроБанк"}},{kind:"Folder",name:"bystrobank",route:"/project-catalogue/bystrobank",children:[{kind:"Meta",data:{guidelines:"Гайдлайны",stubs:"Написание заглушек"}},{kind:"MdxPage",name:"guidelines",route:"/project-catalogue/bystrobank/guidelines"},{kind:"MdxPage",name:"stubs",route:"/project-catalogue/bystrobank/stubs"}]}]},{kind:"Folder",name:"project-managment",route:"/project-managment",children:[{kind:"Folder",name:"NUPP_p3express",route:"/project-managment/NUPP_p3express",children:[{kind:"MdxPage",name:"NUPP-principles",route:"/project-managment/NUPP_p3express/NUPP-principles"},{kind:"Meta",data:{"NUPP-principles":"Nupp Principles"}}]},{kind:"MdxPage",name:"PMBOK6",route:"/project-managment/PMBOK6"},{kind:"Meta",data:{onboarding_pm:"База",work:"Управление проектом",issue:"Постановка issue",escalation:"Эскалация на проекте",requirements:"Оформление задач и требований",integration:"Управление интеграцией",developmentprocess:"Developmentprocess",PMBOK6:"Pmbok6",productmanagement:"Productmanagement"}},{kind:"MdxPage",name:"developmentprocess",route:"/project-managment/developmentprocess"},{kind:"MdxPage",name:"escalation",route:"/project-managment/escalation"},{kind:"MdxPage",name:"integration",route:"/project-managment/integration"},{kind:"MdxPage",name:"issue",route:"/project-managment/issue"},{kind:"MdxPage",name:"onboarding_pm",route:"/project-managment/onboarding_pm"},{kind:"MdxPage",name:"productmanagement",route:"/project-managment/productmanagement"},{kind:"MdxPage",name:"work",route:"/project-managment/work"}]}],flexsearch:{codeblocks:!0},title:"Настройка авторизации LDAP",headings:r},pageNextRoute:"/administration/ldap",nextraLayout:d.ZP,themeConfig:s.Z};n.default=(0,o.j)(l)},9812:function(e,n,a){"use strict";var t=a(5893);a(7294);let o={logo:(0,t.jsx)("span",{children:"Iconicompany docs"}),project:{link:"https://github.com/iconicompany/idocs"},chat:{link:"https://t.me/iconicompany"},docsRepositoryBase:"https://github.com/iconicompany/idocs/blob/main",footer:{text:"Iconicompany docs"}};n.Z=o}},function(e){e.O(0,[774,270,888,179],function(){return e(e.s=204)}),_N_E=e.O()}]);