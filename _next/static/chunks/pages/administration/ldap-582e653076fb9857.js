(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[275],{100:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/administration/ldap",function(){return n(9944)}])},3179:function(e,s,n){"use strict";var a=n(1527);n(959);let t={logo:(0,a.jsx)("span",{children:"Iconicompany docs"}),project:{link:"https://github.com/iconicompany/idocs"},chat:{link:"https://t.me/iconicompany"},docsRepositoryBase:"https://github.com/iconicompany/idocs/blob/main",footer:{text:"Iconicompany docs"}};s.Z=t},9944:function(e,s,n){"use strict";n.r(s);var a=n(1527),t=n(6487),d=n(3517),i=n(3179);n(7709);var o=n(6736);function l(e){let s=Object.assign({h1:"h1",p:"p",a:"a",code:"code",h2:"h2",pre:"pre",span:"span"},(0,o.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{children:"Настройка авторизации LDAP"}),"\n",(0,a.jsx)(s.h1,{children:"Настройка сервера"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://computingforgeeks.com/install-and-configure-openldap-server-ubuntu/",children:"https://computingforgeeks.com/install-and-configure-openldap-server-ubuntu/"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"sudo apt -y install slapd ldap-utils"})}),"\n",(0,a.jsxs)(s.p,{children:["Для повторной настройки сервера: ",(0,a.jsx)(s.code,{children:"sudo dpkg-reconfigure slapd"})]}),"\n",(0,a.jsx)(s.h2,{id:"настройка-клиента",children:"Настройка клиента"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://computingforgeeks.com/how-to-configure-ubuntu-as-ldap-client/",children:"https://computingforgeeks.com/how-to-configure-ubuntu-as-ldap-client/"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"sudo apt -y install libnss-ldap libpam-ldap ldap-utils"})}),"\n",(0,a.jsxs)(s.p,{children:["Для повторной настройки клиента: ",(0,a.jsx)(s.code,{children:"sudo dpkg-reconfigure ldap-auth-config"})]}),"\n",(0,a.jsx)(s.h2,{id:"ssh-keys",children:"ssh keys"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://openssh-ldap-pubkey.readthedocs.io/en/latest/openldap.html",children:"https://openssh-ldap-pubkey.readthedocs.io/en/latest/openldap.html"})}),"\n",(0,a.jsx)(s.p,{children:"Добавить аттрибут"}),"\n",(0,a.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,a.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"curl -o openssh-lpk.ldif https://openssh-ldap-pubkey.readthedocs.io/en/latest/_downloads/484070d0b1da0579a2bc2dda709186fd/openssh-lpk.ldif.txt"})}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"sudo ldapadd -H ldapi:/// -Y EXTERNAL -f openssh-lpk.ldif"})})]})}),"\n",(0,a.jsx)(s.p,{children:"Создать файл /opt/bin/ldapauth.sh"}),"\n",(0,a.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,a.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"#!/bin/bash"})}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"uid=$1"})}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"baseDN=ou=users,dc=iconicompany,dc=com"})}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ldapsearch -x -b $baseDN -s sub \"(&(objectclass=posixAccount)(uid=$uid))\" | sed -n '/^ /{H;d};/sshPublicKey:/x;$g;s/\\n *//g;s/sshPublicKey: //gp'"})})]})}),"\n",(0,a.jsx)(s.p,{children:"/etc/ssh/sshd_config.d/ldapauth.conf:"}),"\n",(0,a.jsx)(s.pre,{"data-language":"text","data-theme":"default",children:(0,a.jsxs)(s.code,{"data-language":"text","data-theme":"default",children:[(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"AuthorizedKeysCommand /opt/bin/ldapauth.sh"})}),"\n",(0,a.jsx)(s.span,{className:"line",children:(0,a.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"AuthorizedKeysCommandUser root"})})]})}),"\n",(0,a.jsx)(s.p,{children:"В конце:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"sudo service sshd restart"})})]})}n(464);let c={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,o.ah)(),e.components);return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)},pageOpts:{filePath:"pages/administration/ldap.md",route:"/administration/ldap",headings:[{depth:1,value:"Настройка авторизации LDAP",id:"настройка-авторизации-ldap"},{depth:1,value:"Настройка сервера",id:"настройка-сервера"},{depth:2,value:"Настройка клиента",id:"настройка-клиента"},{depth:2,value:"ssh keys",id:"ssh-keys"}],pageMap:[{kind:"Meta",data:{index:"Introduction",nodejs:"Nodejs docs",administration:"Servers, databases, clusters",contact:{title:"Contact ↗",type:"page",href:"https://iconicompany.com/",newWindow:!0}}},{kind:"Folder",name:"administration",route:"/administration",children:[{kind:"Meta",data:{server:"Как создать и настроить сервер на Ubuntu",k3s:"Установка k3s",ldap:"Ldap"}},{kind:"MdxPage",name:"k3s",route:"/administration/k3s"},{kind:"MdxPage",name:"ldap",route:"/administration/ldap"},{kind:"MdxPage",name:"server",route:"/administration/server"}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"nodejs",route:"/nodejs",children:[{kind:"Meta",data:{workstation:"How to setup Nodejs developer workstation",packages:"Snippets for packages"}},{kind:"MdxPage",name:"packages",route:"/nodejs/packages"},{kind:"MdxPage",name:"workstation",route:"/nodejs/workstation"}]}],flexsearch:{codeblocks:!0},title:"Настройка сервера"},pageNextRoute:"/administration/ldap",nextraLayout:d.ZP,themeConfig:i.Z};s.default=(0,t.j)(c)}},function(e){e.O(0,[774,183,888,179],function(){return e(e.s=100)}),_N_E=e.O()}]);